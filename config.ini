# DSL 多业务场景 Agent 配置文件模板
# 注意：请勿提交包含真实API Key的配置文件
# 将此文件复制为 config.ini 并根据需要修改

[DEFAULT]
# 基础配置
version = 1.0
app_name = DSL Multi-Agent System
debug = false

# LLM API 配置（优先使用环境变量）
# 支持 OpenAI 兼容接口（如通义千问、百炼、DeepSeek等）
# 环境变量：DSL_API_BASE, DSL_API_KEY, DSL_MODEL
api_base = https://api.openai.com/v1
api_key = sk-你的实际API密钥
model = gpt-3.5-turbo

# 运行模式配置
# use_stub = true 时强制使用桩服务，即使配置了LLM API
# 环境变量：DSL_USE_STUB (true/false)
use_stub = false
show_intent = true

# 文件路径配置
scripts_dir = scripts
scenarios_dir = scenarios
test_data_dir = test/test_data
logs_dir = logs

# 超时设置（秒）
# idle_timeout <= 0 表示关闭空闲超时
idle_timeout = 300
request_timeout = 30
connect_timeout = 10

# 重试配置
max_retries = 3
retry_delay = 1

# 对话配置
max_history_length = 10
enable_context_memory = true

[logging]
# 日志配置
# 日志级别：DEBUG, INFO, WARNING, ERROR, CRITICAL
console_level = WARNING
file_level = INFO
log_format = %(asctime)s - %(name)s - %(levelname)s - %(message)s
date_format = %Y-%m-%d %H:%M:%S
max_file_size = 10485760  # 10MB
backup_count = 5

# 环境变量：DSL_LOG_FILE
log_file = {scenario_name}.log  # 支持变量：{scenario_name}, {date}, {time}

[scenarios]
# 场景默认配置
default_scenario = banking_scenario
auto_load = true
cache_enabled = true
cache_ttl = 300
validation_enabled = true

[dsl_interpreter]
# DSL解释器配置
strict_mode = false
enable_tracing = true
max_execution_depth = 10
max_execution_time = 30

[llm]
# LLM专用配置
temperature = 0.3
max_tokens = 1000
top_p = 0.9
frequency_penalty = 0.0
presence_penalty = 0.0

# 意图识别提示词模板
intent_detection_prompt = |
  请分析用户输入的意图，并提取关键实体。
  用户输入：{user_input}
  可选意图：{available_intents}
  请返回JSON格式：
  {{
    "intent": "意图名称",
    "confidence": 0.0-1.0的置信度,
    "entities": {{
      "实体1": "值",
      "实体2": "值"
    }}
  }}

# 意图描述（用于提升分类准确度）
# 格式：[intent_descriptions.<scenario_name>]
# 示例见下文各场景配置

[welcome.banking_scenario]
# 银行业务场景欢迎语
message = 您好！欢迎使用智能银行助手。我可以帮您查询余额、办理转账、查看账单等业务。
hint = 请输入您要办理的业务，例如："查询余额"、"转账"、"查看账单"

[welcome.ecommerce_scenario]
# 电商客服场景欢迎语
message = 您好！欢迎使用电商客服助手。我可以帮您查询订单、跟踪物流、办理退货等。
hint = 请输入您的问题，例如："我的订单"、"快递查询"、"我要退货"

[welcome.tech_support_scenario]
# 技术支持场景欢迎语
message = 您好！欢迎使用技术支持助手。我可以帮您诊断电脑故障、解决软件安装问题等。
hint = 请描述您遇到的问题，例如："电脑无法开机"、"软件安装失败"、"网络连接问题"

[welcome.weather_scenario]
# 天气查询场景欢迎语
message = 您好！欢迎使用天气查询助手。我可以为您提供天气预报、空气质量、天气预警等信息。
hint = 请输入您要查询的天气信息，例如："北京天气"、"未来三天预报"、"空气质量"

# ==================== 场景特定的意图描述 ====================
# 这些描述会传递给LLM，提升意图识别的准确性

[intent_descriptions.banking_scenario]
# 银行业务意图描述
query_balance = 查询账户余额，用户可能说"查余额"、"余额多少"、"看看还有多少钱"
transfer = 转账汇款，通常包含金额、收款人、账号信息，如"转1000元给张三"
query_bills = 查询账单或交易记录，可能包含时间范围如"本月账单"、"最近一周交易"
apply_loan = 申请贷款或贷款咨询，通常包含贷款金额、期限
reset_password = 修改或重置密码，用户可能说"密码忘了"、"改密码"

[intent_descriptions.ecommerce_scenario]
# 电商客服意图描述
query_order = 查询订单状态，通常包含订单号或手机号
query_logistics = 查询物流信息，通常包含运单号
return_goods = 退货退款，通常包含订单号和退货原因
product_consult = 商品咨询，通常包含商品名称或ID
query_promotion = 查询优惠活动或优惠券
member_service = 会员服务，如查询积分、等级

[intent_descriptions.tech_support_scenario]
# 技术支持意图描述
hardware_trouble = 硬件故障诊断，如电脑无法开机、蓝屏
software_install = 软件安装问题，通常包含软件名和错误代码
network_issue = 网络连接问题，如无法上网、网速慢
account_problem = 账号登录问题，如无法登录、账号锁定
usage_guide = 使用指导或操作指南

[intent_descriptions.weather_scenario]
# 天气查询意图描述
current_weather = 查询当前天气，通常包含城市名
weather_forecast = 天气预报，通常包含城市和天数
air_quality = 空气质量查询，通常包含城市名
weather_warning = 天气预警查询
living_indices = 生活指数查询，如穿衣指数、出行建议
weather_comparison = 多城市天气对比

# ==================== 桩服务配置 ====================

[stub_services]
# 桩服务配置（当 use_stub=true 或 LLM API 不可用时使用）
enabled = true
response_delay = 0.5  # 模拟延迟（秒）
random_failure_rate = 0.0  # 随机失败率 0.0-1.0

# 桩服务响应数据
[stub_responses.banking]
# 银行业务桩响应
get_balance.response = {"success": true, "data": {"amount": 10000, "currency": "CNY", "last_updated": "2024-01-15 10:30:00"}}
verify_transfer.response = {"safe_level": 85, "risk_message": "正常交易"}
execute_transfer.response = {"success": true, "transaction_id": "TXN20240115001", "fee": 5.0, "message": "转账成功"}

[stub_responses.ecommerce]
# 电商业务桩响应
get_orders_by_phone.response = {"count": 2, "orders": [{"order_id": "ORD20240115001", "product_name": "智能手机", "status": "已发货"}]}
get_logistics_info.response = {"success": true, "logistics_company": "顺丰速运", "current_status": "已签收"}

[stub_responses.weather]
# 天气查询桩响应
get_current_weather.response = {"success": true, "temperature": 22.5, "condition": "晴", "humidity": 65}
get_air_quality.response = {"success": true, "aqi": 85, "level": "良", "primary_pollutant": "PM2.5"}

# ==================== 测试配置 ====================

[testing]
# 测试配置
auto_run_tests = false
test_timeout = 60
generate_reports = true
report_format = html  # html, json, xml

[test_coverage]
# 测试覆盖率配置
measure_coverage = true
coverage_report = coverage_report.html
minimum_coverage = 80.0

# ==================== 高级配置 ====================

[advanced]
# 高级配置（一般无需修改）
thread_pool_size = 4
enable_metrics = true
metrics_port = 9090
enable_health_check = true
health_check_interval = 30

[security]
# 安全配置
enable_encryption = false
encryption_key = 
enable_rate_limit = true
rate_limit_requests = 100
rate_limit_period = 3600  # 1小时

[cache]
# 缓存配置
enable_cache = true
cache_type = memory  # memory, redis, file
cache_ttl = 300
max_cache_size = 1000

# 如果使用 Redis
[redis]
host = localhost
port = 6379
db = 0
password = 